<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# slomad

```go
import "github.com/ecshreve/slomad/pkg/slomad"
```

## Index

- [Variables](<#variables>)
- [func convertJob(in *nomadStructs.Job) (*nomadApi.Job, error)](<#func-convertjob>)
- [func extractLabels(ports []*Port) []string](<#func-extractlabels>)
- [func getCSIPluginConfig(j *Job) *nomadStructs.TaskCSIPluginConfig](<#func-getcsipluginconfig>)
- [func getConfig(name string, jt JobType, args []string, ports []*Port, vols []Volume) map[string]interface{}](<#func-getconfig>)
- [func getConstraint(dt DeployTarget) *nomadStructs.Constraint](<#func-getconstraint>)
- [func getDisk() *nomadStructs.EphemeralDisk](<#func-getdisk>)
- [func getGroup(j *Job) *nomadStructs.TaskGroup](<#func-getgroup>)
- [func getMounts(vols []Volume) []*nomadStructs.VolumeMount](<#func-getmounts>)
- [func getNetworks(ports []*Port) []*nomadStructs.NetworkResource](<#func-getnetworks>)
- [func getNomadVolumeReq(vols []Volume) map[string]*nomadStructs.VolumeRequest](<#func-getnomadvolumereq>)
- [func getReschedulePolicy(jt JobType) *nomadStructs.ReschedulePolicy](<#func-getreschedulepolicy>)
- [func getResource(tr TaskResource) *nomadStructs.Resources](<#func-getresource>)
- [func getService(taskName string, portLabel string) *nomadStructs.Service](<#func-getservice>)
- [func getServices(taskName string, portLabels []string) []*nomadStructs.Service](<#func-getservices>)
- [func getTask(j *Job) *nomadStructs.Task](<#func-gettask>)
- [func getTemplates(templates map[string]string) []*nomadStructs.Template](<#func-gettemplates>)
- [func getVolumeStrings(vols []Volume) []string](<#func-getvolumestrings>)
- [func toNomadPort(p *Port) nomadStructs.Port](<#func-tonomadport>)
- [func toNomadPortMap(ports []*Port) map[string][]nomadStructs.Port](<#func-tonomadportmap>)
- [type DeployTarget](<#type-deploytarget>)
- [type Job](<#type-job>)
  - [func (j *Job) GetNomadApiJob(force bool) (*nomadApi.Job, error)](<#func-job-getnomadapijob>)
- [type JobType](<#type-jobtype>)
  - [func (jt JobType) String() string](<#func-jobtype-string>)
- [type Port](<#type-port>)
  - [func BasicPortConfig(val int) []*Port](<#func-basicportconfig>)
  - [func basicPort(val int) *Port](<#func-basicport>)
- [type ResourceValue](<#type-resourcevalue>)
- [type TaskResource](<#type-taskresource>)
- [type Volume](<#type-volume>)


## Variables

```go
var (
    DEFAULT_TASK = TaskResource{CPU: DEFAULT, MEM: DEFAULT}
    TINY_TASK    = TaskResource{CPU: TINY, MEM: TINY}
    SMALL_TASK   = TaskResource{CPU: SMALL, MEM: SMALL}
    LARGE_TASK   = TaskResource{CPU: LARGE, MEM: LARGE}
    XLARGE_TASK  = TaskResource{CPU: XLARGE, MEM: XLARGE}
    MEM_TASK     = TaskResource{CPU: SMALL, MEM: LARGE}
    COMPUTE_TASK = TaskResource{CPU: LARGE, MEM: SMALL}
    PLEX_TASK    = TaskResource{CPU: LARGE, MEM: XXLARGE}
)
```

DeployTargetRegex is a map of DeployTarget to a regex string that matches the target's hostname.

```go
var DeployTargetRegex = map[DeployTarget]string{
    ALL:      "^.*$",
    SERVER:   "^server-[0-9]+$",
    WORKER:   "^worker-[0-9]+$",
    CODERBOX: "^coderbox$",
    DEVBOX:   "^devbox$",
    PLEXBOX:  "^plexbox$",
}
```

## func [convertJob](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/job.go#L58>)

```go
func convertJob(in *nomadStructs.Job) (*nomadApi.Job, error)
```

convertJob converts a Nomad Job to a Nomad API Job.

## func [extractLabels](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L61>)

```go
func extractLabels(ports []*Port) []string
```

extractLabels returns a list of labels from a list of Ports.

## func [getCSIPluginConfig](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/storage.go#L76>)

```go
func getCSIPluginConfig(j *Job) *nomadStructs.TaskCSIPluginConfig
```

getCSIPluginConfig returns a CSIPluginConfig for a given job.

## func [getConfig](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/task.go#L53>)

```go
func getConfig(name string, jt JobType, args []string, ports []*Port, vols []Volume) map[string]interface{}
```

getConfig returns a nomad config struct for a given job.

## func [getConstraint](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/job.go#L75>)

```go
func getConstraint(dt DeployTarget) *nomadStructs.Constraint
```

getConstraint returns a nomad constraint for a given deploy target.

## func [getDisk](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/group.go#L30>)

```go
func getDisk() *nomadStructs.EphemeralDisk
```

getDisk returns a nomad disk struct with a default size for a given job.

## func [getGroup](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/group.go#L8>)

```go
func getGroup(j *Job) *nomadStructs.TaskGroup
```

getGroup returns a nomad task group struct for a given job.

## func [getMounts](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/storage.go#L18>)

```go
func getMounts(vols []Volume) []*nomadStructs.VolumeMount
```

getMounts converts a list of Volumes to a list of Nomad VolumeMounts.

## func [getNetworks](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L70>)

```go
func getNetworks(ports []*Port) []*nomadStructs.NetworkResource
```

getNetworks converts a list of Ports to a list of Nomad NetworkResources.

## func [getNomadVolumeReq](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/storage.go#L53>)

```go
func getNomadVolumeReq(vols []Volume) map[string]*nomadStructs.VolumeRequest
```

getNomadVolumeReq converts a slice of Volumes to map of nomad VolumeRequest.

TODO: validation

## func [getReschedulePolicy](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/group.go#L22>)

```go
func getReschedulePolicy(jt JobType) *nomadStructs.ReschedulePolicy
```

getReschedulePolicy returns a nomad reschedule policy for a given job.

## func [getResource](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/task.go#L27>)

```go
func getResource(tr TaskResource) *nomadStructs.Resources
```

getResource is a helper function to convert a TaskResource to a Nomad Resources struct.

## func [getService](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/service.go#L11>)

```go
func getService(taskName string, portLabel string) *nomadStructs.Service
```

getService returns a nomad service struct for a given task.

## func [getServices](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/service.go#L35>)

```go
func getServices(taskName string, portLabels []string) []*nomadStructs.Service
```

getServices returns a list of services for a given job.

## func [getTask](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/task.go#L10>)

```go
func getTask(j *Job) *nomadStructs.Task
```

getTask returns a nomad task struct for a given job.

## func [getTemplates](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/task.go#L34>)

```go
func getTemplates(templates map[string]string) []*nomadStructs.Template
```

## func [getVolumeStrings](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/storage.go#L36>)

```go
func getVolumeStrings(vols []Volume) []string
```

getVolumeString converts a list of Volumes to a list of Volume strings. These are meant to be passed to the docker driver.

## func [toNomadPort](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L15>)

```go
func toNomadPort(p *Port) nomadStructs.Port
```

## func [toNomadPortMap](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L39>)

```go
func toNomadPortMap(ports []*Port) map[string][]nomadStructs.Port
```

toNomadPortMap converts a list of Ports to a map of static and dynamic ports.

## type [DeployTarget](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/types.go#L4>)

DeployTarget is an enum that represents the target of a job.

```go
type DeployTarget int
```

```go
const (
    UNKNOWN_DEPLOY_TARGET DeployTarget = iota
    ALL
    SERVER
    WORKER
    CODERBOX
    DEVBOX
    PLEXBOX
)
```

## type [Job](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/job.go#L14-L25>)

Job is a struct that represents a Nomad Job.

```go
type Job struct {
    Name      string
    Type      JobType
    Shape     TaskResource
    Target    DeployTarget
    Ports     []*Port
    Volumes   []Volume
    Args      []string
    Env       map[string]string
    User      string
    Templates map[string]string
}
```

### func \(\*Job\) [GetNomadApiJob](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/job.go#L28>)

```go
func (j *Job) GetNomadApiJob(force bool) (*nomadApi.Job, error)
```

GetNomadApiJob returns a nomadApi Job for the given slomad.Job.

## type [JobType](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/types.go#L28>)

JobType is an enum that represents the type of a job.

```go
type JobType int
```

```go
const (
    UNKNOWN_JOB_TYPE JobType = iota
    SERVICE
    SYSTEM
    BATCH
    STORAGE_CONTROLLER
    STORAGE_NODE
)
```

### func \(JobType\) [String](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/types.go#L40>)

```go
func (jt JobType) String() string
```

String implements the Stringer interface for JobType.

## type [Port](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L8-L13>)

Port is a struct that represents a network port for a task.

```go
type Port struct {
    Label  string
    To     int
    From   int
    Static bool
}
```

### func [BasicPortConfig](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L34>)

```go
func BasicPortConfig(val int) []*Port
```

BasicPortConfig returns a list with a single Port element with a default label.

### func [basicPort](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/port.go#L24>)

```go
func basicPort(val int) *Port
```

basicPort returns a basic port struct with a default label.

## type [ResourceValue](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/types.go#L44>)

```go
type ResourceValue int
```

```go
const (
    TINY    ResourceValue = 128
    SMALL   ResourceValue = 256
    DEFAULT ResourceValue = 512
    LARGE   ResourceValue = 1024
    XLARGE  ResourceValue = 2048
    XXLARGE ResourceValue = 4096
)
```

## type [TaskResource](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/types.go#L56-L59>)

TaskResource is a struct that represents the CPU and MEM resources for a task.

```go
type TaskResource struct {
    CPU ResourceValue
    MEM ResourceValue
}
```

## type [Volume](<https://github.com/ecshreve/slomad/blob/main/pkg/slomad/storage.go#L11-L15>)

```go
type Volume struct {
    Src   string
    Dst   string
    Mount bool
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
